# optimize eGFP protein
import pandas as pd
from optimalcodon.projects.rnastability.optimization import protein_optimization

# params
mdl_path = '../19-04-30-PredictiveModelDecayAllSpecies/19-05-01-TrainModels/results_data/final_model_gbm.joblib'
n_iterations = 100
# optimize human gene that is midl stable in RPE

gene_name = "Cas13d"
seq = "ATGGcgagcgaggccagcatcgaaaaaaaaaagtccttcgccaagggcatgggcgtgaagtccacactcgtgtccggctccaaagtgtacatgacaaccttcgccgaaggcagcgacgccaggctggaaaagatcgtggagggcgacagcatcaggagcgtgaatgagggcgaggccttcagcgctgaaatggccgataaaaacgccggctataagatcggcaacgccaaattcagccatcctaagggctacgccgtggtggctaacaaccctctgtatacaggacccgtccagcaggatatgctcggcctgaaggaaactctggaaaagaggtacttcggcgagagcgctgatggcaatgacaatatttgtatccaggtgatccataacatcctggacattgaaaaaatcctcgccgaatacattaccaacgccgcctacgccgtcaacaatatctccggcctggataaggacattattggattcggcaagttctccacagtgtatacctacgacgaattcaaagaccccgagcaccatagggccgctttcaacaataacgataagctcatcaacgccatcaaggcccagtatgacgagttcgacaacttcctcgataaccccagactcggctatttcggccaggcctttttcagcaaggagggcagaaattacatcatcaattacggcaacgaatgctatgacattctggccctcctgagcggactgaggcactgggtggtccataacaacgaagaagagtccaggatctccaggacctggctctacaacctcgataagaacctcgacaacgaatacatctccaccctcaactacctctacgacaggatcaccaatgagctgaccaactccttctccaagaactccgccgccaacgtgaactatattgccgaaactctgggaatcaaccctgccgaattcgccgaacaatatttcagattcagcattatgaaagagcagaaaaacctcggattcaatatcaccaagctcagggaagtgatgctggacaggaaggatatgtccgagatcaggaaaaatcataaggtgttcgactccatcaggaccaaggtctacaccatgatggactttgtgatttataggtattacatcgaagaggatgccaaggtggctgccgccaataagtccctccccgataatgagaagtccctgagcgagaaggatatctttgtgattaacctgaggggctccttcaacgacgaccagaaggatgccctctactacgatgaagctaatagaatttggagaaagctcgaaaatatcatgcacaacatcaaggaatttaggggaaacaagacaagagagtataagaagaaggacgcccctagactgcccagaatcctgcccgctggccgtgatgtttccgccttcagcaaactcatgtatgccctgaccatgttcctggatggcaaggagatcaacgacctcctgaccaccctgattaataaattcgataacatccagagcttcctgaaggtgatgcctctcatcggagtcaacgctaagttcgtggaggaatacgcctttttcaaagactccgccaagatcgccgatgagctgaggctgatcaagtccttcgctagaatgggagaacctattgccgatgccaggagggccatgtatatcgacgccatccgtattttaggaaccaacctgtcctatgatgagctcaaggccctcgccgacaccttttccctggacgagaacggaaacaagctcaagaaaggcaagcacggcatgagaaatttcattattaataacgtgatcagcaataaaaggttccactacctgatcagatacggtgatcctgcccacctccatgagatcgccaaaaacgaggccgtggtgaagttcgtgctcggcaggatcgctgacatccagaaaaaacagggccagaacggcaagaaccagatcgacaggtactacgaaacttgtatcggaaaggataagggcaagagcgtgagcgaaaaggtggacgctctcacaaagatcatcaccggaatgaactacgaccaattcgacaagaaaaggagcgtcattgaggacaccggcagggaaaacgccgagagggagaagtttaaaaagatcatcagcctgtacctcaccgtgatctaccacatcctcaagaatattgtcaatatcaacgccaggtacgtcatcggattccattgcgtcgagcgtgatgctcaactgtacaaggagaaaggctacgacatcaatctcaagaaactggaagagaagggattcagctccgtcaccaagctctgcgctggcattgatgaaactgcccccgataagagaaaggacgtggaaaaggagatggctgaaagagccaaggagagcattgacagcctcgagagcgccaaccccaagctgtatgccaattacatcaaatacagcgacgagaagaaagccgaggagttcaccaggcagattaacagggagaaggccaaaaccgccctgaacgcctacctgaggaacaccaagtggaatgtgatcatcagggaggacctcctgagaattgacaacaagacatgtaccctgttcagaaacaaggccgtccacctggaagtggccaggtatgtccacgcctatatcaacgacattgccgaggtcaattcctacttccaactgtaccattacatcatgcagagaattatcatgaatgagaggtacgagaaaagcagcggaaaggtgtccgagtacttcgacgctgtgaatgacgagaagaagtacaacgataggctcctgaaactgctgtgtgtgcctttcggctactgtatccccaggtttaagaacctgagcatcgaggccctgttcgataggaacgaggccgccaagttcgacaaggagaaaaagaaggtgtccggcaattccggatccggagcggccgcttacccatacgatgttccagattacgcttaa"
seq = seq.upper()
# optimize gene in rpe
mdl_params = {'specie': 'fish', 'cell_type': 'embryo mzt',
              'datatype': 'aamanitin polya'}
gfp_path = protein_optimization(
    seq, mdl_path, mdl_params, crossover_args={}, niterations=n_iterations)

gfp_path.to_csv('results_data/Cas13d_optimization_path.csv')
